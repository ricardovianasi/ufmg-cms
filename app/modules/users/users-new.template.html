<div class="page-title">
    <div class="row flexcenter">
        <div class="col-md-6">
            <div class="title-env">
                <h1 class="title">Novo Usuário</h1>
            </div>
        </div>
        <div class="col-md-6">
            <div class="breadcrumb-env">
                <ol class="breadcrumb bc-1">
                    <li>
                        <a href="#/"><i class="fa-home"></i>Home</a>
                    </li>
                    <li>
                        <a href="#/users">
                            Usuários
                        </a>
                    </li>
                    <li class="active">
                        <a href="#/users/new">
                            <strong>Novo Usuário</strong>
                        </a>
                    </li>
                </ol>
            </div>
            <!--breadcrumb-env-->
        </div>
    </div>
</div>
<ul class="nav nav-tabs">
    <li ng-class="{active:vm.isSet(1)}">
        <a href ng-click="vm.setTab(1)">
            <span class="hidden-xs">Informações</span>
        </a>
    </li>
    <li ng-class="{active:vm.isSet(2)}">
        <a href ng-click="vm.setTab(2)">
            <span class="hidden-xs">Permissões</span>
        </a>
    </li>
</ul>
<div class="tab-pane tab-content" ng-show="vm.isSet(1)">
    <div class="row">
        <form class="form" name="formUsers" novalidate>
            <div class="col-xs-12 form-group">
                <h5><strong>Status:</strong></h5>
                <label>
                        <input type="radio" ng-model="vm.user.status" name="status[]" value="1">
                        Ativo
                    </label>
                <label style="margin-left: 15px;">
                        <input type="radio" ng-model="vm.user.status" name="status[]" value="0">
                        Inativo
                    </label>
                <hr>
            </div>
            <div class="col-xs-12">
                <h5><strong>Informações Gerais:</strong></h5>
                <br>
            </div>
            <div class="col-xs-6">
                <div class="form-group" ng-class="{'has-error': formUsers.user_name.$error.required && !formUsers.user_name.$valid}">
                    <label for="user_name">Nome:</label>
                    <input id="user_name" type="text" name="user_name" class="form-control" ng-model="vm.user.name" required>
                    <div ng-show="!formUsers.user_name.$valid" class="error-message" role="alert">
                        <div ng-show="formUsers.user_name.$error.required">Campo obrigatório</div>
                    </div>
                </div>
                <div class="form-group" ng-class="{'has-error': formUsers.user_email.$error.required && !formUsers.user_email.$valid}">
                    <label for="user_email">Email:</label>
                    <input id="user_email" type="email" name="user_email" class="form-control" ng-model="vm.user.email" required>
                    <div ng-show="!formUsers.user_email.$valid" class="error-message" role="alert">
                        <div ng-show="formUsers.user_email.$error.required">Campo obrigatório</div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="user_commercial_phone">Telefone comercial:</label>
                    <input id="user_commercial_phone" type="text" name="user_commercial_phone" class="form-control" ng-model="vm.user.commercial_phone" ui-br-phone-number>
                </div>
                <div class="form-group">
                    <label for="user_home_phone">Telefone residencial:</label>
                    <input id="user_home_phone" type="text" name="user_home_phone" class="form-control" ng-model="vm.user.home_phone" ui-br-phone-number>
                </div>
                <div class="form-group">
                    <label for="user_mobile_phone">Telefone celular:</label>
                    <input id="user_mobile_phone" type="text" name="user_mobile_phone" class="form-control" ng-model="vm.user.mobile_phone" ui-br-phone-number>
                </div>
            </div>
            <div class="col-xs-6">
                <div class="form-group" ng-class="{'has-error': formUsers.user_unit.$error.required && !formUsers.user_unit.$valid}">
                    <label for="user_unit">Unidade:</label>
                    <input id="user_unit" type="text" name="user_unit" class="form-control" ng-model="vm.user.unit" required>
                    <div ng-show="!formUsers.user_unit.$valid" class="error-message" role="alert">
                        <div ng-show="formUsers.user_unit.$error.required">Campo obrigatório</div>
                    </div>
                </div>
                <div class="form-group" ng-class="{'has-error': formUsers.user_sector.$error.required && !formUsers.user_sector.$valid}">
                    <label for="user_sector">Setor:</label>
                    <input id="user_sector" type="text" name="user_sector" class="form-control" ng-model="vm.user.sector" required>
                    <div ng-show="!formUsers.user_sector.$valid" class="error-message" role="alert">
                        <div ng-show="formUsers.user_sector.$error.required">Campo obrigatório</div>
                    </div>
                </div>
                <div class="form-group" ng-class="{'has-error': formUsers.user_occupation.$error.required && !formUsers.user_occupation.$valid}">
                    <label for="user_occupation">Cargo:</label>
                    <input id="user_occupation" type="text" name="user_occupation" class="form-control" ng-model="vm.user.occupation" required>
                    <div ng-show="!formUsers.user_occupation.$valid" class="error-message" role="alert">
                        <div ng-show="formUsers.user_occupation.$error.required">Campo obrigatório</div>
                    </div>
                </div>
                <div class="form-group" ng-class="{'has-error': formUsers.user_function.$error.required && !formUsers.user_function.$valid}">
                    <label for="user_function">Função:</label>
                    <input id="user_function" type="text" name="user_function" class="form-control" ng-model="vm.user.function" required>
                    <div ng-show="!formUsers.user_function.$valid" class="error-message" role="alert">
                        <div ng-show="formUsers.user_function.$error.required">Campo obrigatório</div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="user_site">Site:</label>
                    <input id="user_site" type="text" name="user_site" class="form-control" ng-model="vm.user.site">
                </div>
            </div>
        </form>
    </div>
</div>
<div class="tab-pane tab-content" ng-show="vm.isSet(2)">
    <v-accordion class="vAccordion--default" multiple>
        <div class="row">
            <div class="col-xs-12">
                <h5><strong>Tipo de Usuário:</strong></h5>
                <label>
                        <input type="radio" ng-model="vm.user.is_administrator" ng-value="false">
                        Padrão
                    </label>
                <label style="margin-left: 15px;">
                        <input type="radio" ng-model="vm.user.is_administrator" ng-value="true">
                        Administrador
                    </label>
                <hr>
            </div>
            <div class="col-xs-12">
                <h5><strong>Usuário moderado por:</strong></h5>
                <select class="form-control" ng-model="vm.user.moderator" ng-options="item.id as item.name for item in vm.users | orderBy: 'name' track by item.id">
                    </select>
                <p><i>Todo conteúdo produzido só é publicado após a aprovação do moderador</i></p>
                <hr>
            </div>
            <div class="col-xs-12">
                <v-pane ng-repeat="(key, value) in vm.resources track by $index">
                    <v-pane-header>
                        {{ value.alias }}
                    </v-pane-header>
                    <v-pane-content>
                        <div class="checkbox">
                            <label ng-repeat="(key, value) in value.privileges track by $index" class="checkLabel" ng-class="$parent.key+'_'+key">
                                    <input type="checkbox" ng-hide="vm.user.resources_perms[$parent.key][key]" checklist-model="vm.user.resources_perms[$parent.key][key]" checklist-value="key">{{ value }}

                                    <!-- Select edit page -->
                                    <select class="form-control" ng-show="$parent.key+'_'+key == 'page_PUT'"
                                            ng-model="vm.user.resources_perms.page.PUT"
                                            ng-change="vm.getPages()">
                                        <option ng-repeat="option in vm.pagesParent | orderBy: 'title'"
                                                value="{{option.id}}">{{option.title}}
                                        </option>
                                    </select>

                                    <!-- Select create, edit, delete periodicals editions -->
                                    <select class="form-control" ng-show="$parent.key+'_'+key == 'editions_POST'"
                                            ng-model="vm.user.resources_perms.periodical.POST"
                                            ng-change="vm.getPeriodicals()">
                                        <option ng-repeat="option in vm.periodicals | orderBy: 'name'"
                                                value="{{option.id}}">{{option.name}}</option>
                                    </select>
                                    <select class="form-control" ng-show="$parent.key+'_'+key == 'editions_PUT'"
                                            ng-model="vm.user.resources_perms.periodical.PUT"
                                            ng-change="vm.getPeriodicals()">
                                        <option ng-repeat="option in vm.periodicals | orderBy: 'name'"
                                                value="{{option.id}}">{{option.name}}</option>
                                    </select>
                                    <select class="form-control" ng-show="$parent.key+'_'+key == 'editions_DELETE'"
                                            ng-model="vm.user.resources_perms.periodical.DELETE"
                                            ng-change="vm.getPeriodicals()">
                                        <option ng-repeat="option in vm.periodicals | orderBy: 'name'"
                                                value="{{option.id}}">{{option.name}}</option>
                                    </select>

                                    <!-- Select cursos de Graduação -->
                                    <select class="form-control" ng-show="$parent.key+'_'+key == 'course_graduation_PUT'"
                                            ng-model="vm.user.resources_perms.course_graduation.PUT"
                                            ng-change="vm.getGraduation()">
                                        <option ng-repeat="option in vm.courses_g | orderBy: 'name'"
                                                value="{{option.id}}">{{option.name}}</option>
                                    </select>

                                    <!-- Select cursos de Mestrado -->
                                    <select class="form-control" ng-show="$parent.key+'_'+key == 'course_master_PUT'"
                                            ng-model="vm.user.resources_perms.course_master.PUT"
                                            ng-change="vm.getMaster()">
                                        <option ng-repeat="option in vm.courses_m | orderBy: 'name'"
                                                value="{{option.id}}">{{option.name}}</option>
                                    </select>

                                    <!-- Select cursos de Doutorado -->
                                    <select class="form-control" ng-show="$parent.key+'_'+key == 'course_doctorate_PUT'"
                                            ng-model="vm.user.resources_perms.course_doctorate.PUT"
                                            ng-change="vm.getDoctorate()">
                                        <option ng-repeat="option in vm.courses_d | orderBy: 'name'"
                                                value="{{option.id}}">{{option.name}}</option>
                                    </select>

                                    <!-- Select cursos de Especialização -->
                                    <select class="form-control" ng-show="$parent.key+'_'+key == 'course_specialization_PUT'"
                                            ng-model="vm.user.resources_perms.course_specialization.PUT"
                                            ng-change="vm.getSpecialization()">
                                        <option ng-repeat="option in vm.courses_s | orderBy: 'name'"
                                                value="{{option.id}}">{{option.name}}</option>
                                    </select>

                                </label>
                        </div>
                    </v-pane-content>
                </v-pane>
            </div>
        </div>
    </v-accordion>
</div>
<div class="row">
    <div class="col-md-12 text-right">
        <hr/>
        <a href="" class="btn btn-secondary btn-lg" ng-click="vm.save()">
            <i class="fa fa-check"></i> Salvar Usuário
        </a>
    </div>
</div>
