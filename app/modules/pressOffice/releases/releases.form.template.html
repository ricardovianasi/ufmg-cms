<div class="page-title">
    <div class="row flex-center">
        <div class="col-md-6">
            <div class="title-env">
                <h1 class="title">
                    <span ng-if="release.id">
                       <span ng-if="release.title">Editar Release - {{ release.title }}</span>
                    <span ng-if="!release.title">Editar Release</span>
                    </span>
                    <span ng-if="!release.id">
                       <span ng-if="release.title">Novo Release - {{ release.title }}</span>
                    <span ng-if="!release.title">Novo Release</span>
                    </span>
                </h1>
            </div>
        </div>
        <div class="col-md-6">
            <div class="breadcrumb-env">
                <ol class="breadcrumb bc-1">
                    <li>
                        <a href="#/">
                            <i class="fa-home"></i>Home
                        </a>
                    </li>
                    <li>
                        <a href="#/release">
                            <strong>Release</strong>
                        </a>
                    </li>
                    <li class="active">
                        <a href="#/gallery/new">
                            <strong>Novo release</strong>
                        </a>
                    </li>
                </ol>
            </div>
        </div>
    </div>
</div>
<div class="row" can-get>
    <form class="form" name="formData" novalidate>
        <div class="col-xs-8 panel panel-default">
            <div class="row">
                <div class="col-xs-12">
                    <div class="form-group" ng-class="{'has-error': formData.title.$error.required && !formData.title.$valid}">
                        <label for="title">Título</label>
                        <input id="title" name="title" type="text" ng-model="release.title" class="form-control" required>
                        <div ng-show="!formData.title.$valid" class="error-message" role="alert">
                            <div ng-show="formData.title.$error.required">Campo obrigatório</div>
                        </div>
                    </div>
                </div>
            </div>
            <!--row-->
            <div class="row">
                <div class="col-xs-12">
                    <div class="form-group">
                        <label for="title">Slug</label>
                        <input id="slug" type="text" name="slug" class="form-control" ng-model="release.slug.slug">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-6">
                    <div class="form-group">
                        <label for="subtitle">Bigode</label>
                        <input id="subtitle" name="subtitle" type="text" ng-model="release.subtitle" class="form-control">
                    </div>
                </div>
                <div class="col-xs-6">
                    <div class="form-group">
                        <label for="authorName">Autor</label>
                        <input id="authorName" name="authorName" type="text" ng-model="release.authorName" class="form-control">
                    </div>
                </div>
            </div>
            <!--row-->
            <div class="row">
                <div class="col-xs-12">
                    <label for="subtitle">Thumb</label>
                    <div class="pages-module add-module">
                        <div class="chosen-cover">
                            <a href="javascript:void(0);" class="label label-danger remove-image" ng-click="imgHandler.removeImage('thumb')" ng-show="release.thumb">
                                <i class="fa fa-remove"></i> REMOVER IMAGEM
                            </a>
                        </div>
                        <div class="add-title" ng-model="page_cover" ng-click="upload()" ng-show=!release.thumb>+ Adicionar Thumb
                        </div>
                        <div class="uploaded-image" ng-show="release.thumb">
                            <img class="img-responsive" ng-src="{{ release.thumb.url }}">
                        </div>
                    </div>
                </div>
            </div>
            <!--row-->
            <div class="row">
                <div class="col-xs-12">
                    <div class="form-group" ng-class="{'has-error': formData.content.$error.required && !formData.content.$valid}">
                        <label for="content">Conteúdo</label>
                        <div ng-if="viewOnly" id="redactor-only"></div>
                        <textarea id="content" ng-if="!viewOnly" name="content" cols="30" rows="5" ng-model="release.content" redactor="redactorOptions"
                            required></textarea>
                        <div ng-show="!formData.content.$valid" class="error-message" role="alert">
                            <div ng-show="formData.content.$error.required">Campo obrigatório</div>
                        </div>
                    </div>
                </div>
            </div>
            <!--row-->
            <hr>
            <h3>Fonte</h3>
            <div class="row">
                <div class="col-xs-12">
                    <div class="form-group" ng-class="{'has-error': formData.name.$error.required && !formData.name.$valid}">
                        <label for="name">Nome</label>
                        <input id="name" name="name" type="text" ng-model="release.source.name" class="form-control" required>
                        <div ng-show="!formData.name.$valid" class="error-message" role="alert">
                            <div ng-show="formData.name.$error.required">Campo obrigatório</div>
                        </div>
                    </div>
                </div>
            </div>
            <!--row-->
            <div class="row">
                <div class="col-xs-6">
                    <div class="form-group" ng-class="{'has-error': formData.email.$error.required && !formData.email.$valid}">
                        <label for="email">E-mail</label>
                        <input id="email" type="text" name="email" ng-model="release.source.email" class="form-control" required>
                        <div ng-show="!formData.email.$valid" class="error-message" role="alert">
                            <div ng-show="formData.email.$error.required">Campo obrigatório</div>
                        </div>
                    </div>
                </div>
                <div class="col-xs-6">
                    <div class="form-group">
                        <label for="phone">Telefone</label>
                        <input id="phone" type="text" name="phone" ng-model="release.source.phone" class="form-control">
                    </div>
                </div>
            </div>
            <!--row-->
            <div class="row">
                <div class="col-xs-12">
                    <div class="form-group">
                        <label for="name">URL:</label>
                        <input id="name" name="url" type="text" ng-model="release.source.url" class="form-control">
                    </div>
                </div>
            </div>
            <!--row-->
            <hr>
            <h3>Serviços</h3>
            <div class="row">
                <div class="col-xs-12">
                    <div class="form-group">
                        <label for="whats">O que é</label>
                        <input id="whats" type="text" name="whats" ng-model="release.service.whats" class="form-control">
                    </div>
                </div>
            </div>
            <!--row-->
            <div class="row">
                <div class="col-xs-12">
                    <div class="form-group">
                        <div class="row">
                            <div class="col-xs-6">
                                <label for="" class="">Data:</label>
                                <input type="text" ng-model="release.service.when" class="form-control">
                            </div>
                            <div class="col-xs-6">
                                <label for="" class="">Horário:</label>
                                <input type="text" ng-model="release.service.time" class="form-control">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xs-12">
                    <div class="form-group">
                        <label for="where">Onde</label>
                        <input id="where" type="text" name="where" ng-model="release.service.where" class="form-control">
                    </div>
                </div>
            </div>
            <!--row-->
            <hr>
            <h3>
                Arquivos
            </h3>
            <div class="row">
                <div class="col-xs-12">
                    <div ng-repeat="(idx, file) in release.files" class="well well-sm">
                        <div ng-click="release.files[idx].opened = true" class="clearfix">
                            <div class="pull-left">
                                <label style="cursor: pointer">Arquivo {{ idx + 1 }}</label>
                            </div>
                            <div class="pull-right">
                                <button type="button" class="btn btn-danger btn-sm" ng-click="fileHandler.removeItem(idx)">
                                    <i class="fa fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div ng-show="release.files[idx].opened">
                            <div class="form-group">
                                <ul class="nav nav-tabs nav-tabs-justified">
                                    <li ng-class="{ active: release.files[idx].isFile }" ng-click="release.files[idx].isFile = true">
                                        <span class="visible-xs"><i class="fa fa-home"></i></span>
                                        <span class="hidden-xs">Arquivos (Upload)</span>
                                    </li>
                                    <li ng-class="{ active: !release.files[idx].isFile }" ng-click="release.files[idx].isFile = false">
                                        <span class="visible-xs"><i class="fa fa-upload"></i></span>
                                        <span class="hidden-xs">Vídeo (URL)</span>
                                    </li>
                                </ul>
                                <div class="tab-content">
                                    <div class="tab-pane" ng-class="{ active: release.files[idx].isFile }" id="upload">
                                        <a style="margin-top: 20px" class="pages-module pages-module-cover add-module" ng-href="{{release.files[idx].external_url}}"
                                            target="__blank">
                                            <div class="chosen-cover">
                                                <span class="label label-danger remove-image" ng-click="removeReleasesFiles(idx)" ng-show="release.files[idx].file">
                                <span class="fa fa-remove"></span> Remover
                                                </span>
                                            </div>
                                            <div class="add-title" ng-show="!release.files[idx].file" ng-click="addFile(idx)">+ Adicionar Arquivo</div>
                                            <div ng-if="release.files[idx].file">
                                                <div class="file-icon file-icon-lg" ng-if="!(release.files[idx].type === 'png' || release.files[idx].type === 'jpg' || release.files[idx].type === 'free')"
                                                    data-type="{{release.files[idx].type}}"></div>
                                                <div class="uploaded-image" ng-if="release.files[idx].type === 'png' || release.files[idx].type === 'jpg' || release.files[idx].type === 'free'">
                                                    <img class="img-responsive" ng-src="{{ release.files[idx].thumb }}">
                                                </div>
                                            </div>
                                        </a>
                                        <br>
                                        <label class="text-left" ng-show="release.files[idx].file">Breve descrição - {{release.files[idx].file.type}}</label>
                                        <input type="text" class="form-control" ng-model="release.files[idx].title" ng-show="release.files[idx].file">
                                        <br>
                                    </div>
                                    <div class="tab-pane
                                        " ng-class="{ active: !release.files[idx].isFile }" id="video">
                                        <input type="text" placeholder="Inserir URL do Vídeo (Youtube ou Vimeo)..." ng-model="release.files[idx].external_url" class="form-control"
                                            ng-show="release.files[idx].isFile == false">
                                        <br>
                                        <label class="text-left">Breve descrição</label>
                                        <input type="text" class="form-control" ng-model="release.files[idx].title" ng-show="release.files[idx].isFile == false">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <a class="pages-module add-module" ng-click="fileHandler.addItem()">
                <span class="add-title">
                            + Novo Arquivo
                        </span>
            </a>
                </div>
            </div>
        </div>
        <div class="col-xs-4">
            <publishment-options route-model="release"></publishment-options>
        </div>
    </form>
</div>
<br/>
<br/>
<ng-include src="'components/widget/partials/redactor-templates.html'"></ng-include>
